<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stopwatch with Laps</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: #f4f4f4; }
        h1 { margin-top: 20px; }
        #timer { font-size: 2em; margin: 20px 0; }
        button { padding: 10px 20px; margin: 5px; font-size: 1em; cursor: pointer; }
        #laps { list-style: none; padding: 0; margin-top: 20px; }
        .lap-item { background: white; padding: 5px; margin: 5px auto; width: 200px; border-radius: 5px; }
    </style>
</head>
<body>

    <h1>Stopwatch</h1>
    <div id="timer">00:00.000</div>
    
    <button id="startPause">START</button>
    <button id="lap" style="display: none;">LAP</button>
    <button id="reset" style="display: none;">RESET</button>

    <h2>Lap Times</h2>
    <ul id="laps"></ul>
    
    <script>
        let startTime = 0;
        let elapsedTime = 0;
        let timerInterval;
        let running = false;
        let laps = [];
        let lapCount = 0;
        let totalLapTime = 0;

        const timerDisplay = document.getElementById("timer");
        const startPauseBtn = document.getElementById("startPause");
        const lapBtn = document.getElementById("lap");
        const resetBtn = document.getElementById("reset");
        const lapsList = document.getElementById("laps");

        function formatTime(ms) {
            let minutes = Math.floor(ms / 60000);
            let seconds = Math.floor((ms % 60000) / 1000);
            let milliseconds = Math.floor((ms % 1000) / 10);
            return (
                String(minutes).padStart(2, "0") + ":" +
                String(seconds).padStart(2, "0") + "." +
                String(milliseconds).padStart(3, "0")
            );
        }

        function startPause() {
            if (!running) {
                startTime = Date.now() - elapsedTime;
                timerInterval = setInterval(() => {
                    elapsedTime = Date.now() - startTime;
                    timerDisplay.innerText = formatTime(elapsedTime);
                }, 10);
                startPauseBtn.innerText = "Pause";
                startPauseBtn.style.backgroundColor = "red";
                lapBtn.style.display = "inline-block";
                resetBtn.style.display = "none"; // Hide reset when running
                running = true;
            } else {
                clearInterval(timerInterval);
                startPauseBtn.innerText = "Resume";
                startPauseBtn.style.backgroundColor = "green";
                resetBtn.style.display = "inline-block";
                lapBtn.style.display = "none"; // Hide lap when paused
                running = false;
            }
        }

        function recordLap() {
            if (!running) return;
            let lapTime = elapsedTime - (laps.length > 0 ? laps[laps.length - 1] : 0);
            laps.push(elapsedTime);
            lapCount++;

            totalLapTime += lapTime;
            let avgLapTime = totalLapTime / lapCount;

            const lapItem = document.createElement("li");
            lapItem.classList.add("lap-item");
            lapItem.innerText = `Lap ${lapCount}: ${formatTime(lapTime)}`;
            lapsList.appendChild(lapItem);
        }

        function resetTimer() {
            if (confirm("Are you sure you want to reset? This will clear all lap times and restart the stopwatch.")) {
                if (!confirm("This action is permanent. Do you REALLY want to reset? Have you recorded the Overall Time, Lap #, and Avg. Lap Time?")) {
                    return;
                }
                
                clearInterval(timerInterval);
                startTime = 0;
                elapsedTime = 0;
                laps = [];
                lapCount = 0;
                totalLapTime = 0;
                running = false;
                
                timerDisplay.innerText = "00:00.000";
                startPauseBtn.innerText = "START";
                startPauseBtn.style.backgroundColor = "";
                resetBtn.style.display = "none";
                lapBtn.style.display = "none";
                lapsList.innerHTML = "";
            }
        }

        startPauseBtn.addEventListener("click", startPause);
        lapBtn.addEventListener("click", recordLap);
        resetBtn.addEventListener("click", resetTimer);
    </script>

</body>
</html>
